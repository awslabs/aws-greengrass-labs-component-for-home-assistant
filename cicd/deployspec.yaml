# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
# SPDX-License-Identifier: Apache-2.0

version: 0.2

phases:
  pre_build:
    commands:
      # Log the versions of all tools
      - python3 --version
      - jq --version
  
  build:
    commands:
      # Extract the component version genertaed by the build stage of the pipeline
      - COMPONENT_VERSION=$(cat gdk-config.json | jq -r '.component."aws.greengrass.labs.HomeAssistant".version')

      # Deploy the component version
      - python3 deploy_component_version.py $COMPONENT_VERSION $GREENGRASS_CORE_NAME

  post_build:
    commands:
